# Nanobot Web 界面功能说明

## 概述

Nanobot Web 界面是一个功能完整的 AI 助手交互平台，提供对话、配置和监控功能。界面设计参考了 OpenClaw 和原始 nanobot 项目，提供现代化的用户体验。

## 主要功能

### 1. AI 对话界面 💬

#### 功能特性
- **实时对话**: 与 AI 进行自然语言交互
- **流式响应**: 实时显示 AI 回复内容
- **多轮对话**: 支持上下文记忆的连续对话
- **消息历史**: 自动保存对话历史记录
- **工具调用可视化**: 显示 AI 使用的工具和执行结果

#### 使用方法
1. 在输入框中输入问题
2. 按 Enter 或点击"发送"按钮
3. 等待 AI 响应（显示加载动画）
4. 查看 AI 回复和工具执行结果

#### 支持的任务
- 文件操作（读取、写入、编辑）
- Shell 命令执行
- 网页搜索和抓取
- 代码编写和分析
- 数据处理和分析

### 2. 会话管理 📋

#### 功能特性
- **多会话支持**: 同时管理多个独立对话
- **会话切换**: 快速在不同会话间切换
- **会话创建**: 一键创建新会话
- **会话删除**: 清理不需要的会话
- **会话统计**: 显示每个会话的消息数和 Token 使用量

#### 使用方法
1. 点击"新建会话"创建新对话
2. 点击会话名称切换到该会话
3. 点击"删除"按钮移除会话
4. 默认会话始终存在，不可删除

### 3. 系统监控 📊

#### 实时监控指标

**内存使用**
- 已使用内存（MB）
- 总内存（MB）
- 最大内存（MB）
- 使用百分比（进度条显示）

**系统状态**
- 运行状态（运行中/停止）
- 活跃会话数量
- 消息队列大小
- 子代理数量

**消息总线**
- 入站队列大小
- 出站队列大小
- 活跃通道数
- 总消息数

**事件总线**
- 事件日志大小
- 事件类型数量
- 处理器数量

#### 自动刷新
- 每 3 秒自动更新数据
- 显示最后更新时间
- 无需手动刷新

### 4. 工具管理 🛠️

#### 可用工具列表
- **read_file**: 读取文件内容
- **write_file**: 写入文件内容
- **shell**: 执行 Shell 命令
- **web_fetch**: 抓取网页内容

#### 工具信息
- 工具名称
- 工具描述
- 参数说明
- 是否需要工作空间

### 5. 配置管理 ⚙️

#### 支持的配置项
- **模型选择**: GPT-4, GPT-4 Turbo, GPT-3.5 Turbo, Claude 3.5 Sonnet, Claude 3 Opus, DeepSeek Chat, Qwen Max, Gemini Pro
- **温度参数**: 控制回复的随机性（0.0-2.0）
- **最大迭代次数**: 限制工具调用次数（1-50）
- **系统提示词**: 自定义 AI 行为

## API 接口文档

### 对话接口

#### POST /api/chat
发送消息并获取 AI 响应

**请求体**:
```json
{
  "sessionId": "session-123",
  "message": "你好，请帮我读取 README.md 文件"
}
```

**响应**:
```json
{
  "response": "我已经读取了 README.md 文件...",
  "sessionId": "session-123",
  "timestamp": 1234567890
}
```

#### GET /api/stream
Server-Sent Events (SSE) 流式响应接口

**响应**: 持续的事件流
```
data: {"type": "message", "content": "正在处理..."}
data: {"type": "tool", "name": "read_file", "status": "executing"}
data: {"type": "response", "content": "文件内容是..."}
```

### 会话管理

#### GET /api/sessions
获取所有会话列表

**响应**:
```json
{
  "sessions": [
    {
      "sessionId": "default",
      "messageCount": 10,
      "estimatedTokens": 2500,
      "oldestMessage": 1234567890,
      "latestMessage": 1234567900
    }
  ]
}
```

#### DELETE /api/sessions?sessionId=xxx
清除指定会话

**响应**:
```json
{
  "message": "Session cleared"
}
```

### 配置管理

#### GET /api/config
获取当前配置

**响应**:
```json
{
  "models": ["gpt-4", "claude-3-5-sonnet-20241022", ...],
  "currentModel": "gpt-4",
  "temperature": 0.7,
  "maxIterations": 20
}
```

### 工具管理

#### GET /api/tools
获取可用工具列表

**响应**:
```json
{
  "tools": [
    {
      "name": "read_file",
      "description": "Read contents of a file"
    },
    ...
  ]
}
```

### 监控接口

#### GET /api/stats
获取系统统计数据

**响应**:
```json
{
  "memory": {
    "used": 100,
    "total": 512,
    "max": 2048,
    "free": 412
  },
  "sessions": 3,
  "timestamp": 1234567890
}
```

#### GET /api/health
健康检查

**响应**:
```json
{
  "status": "ok",
  "timestamp": 1234567890
}
```

## 技术特性

### 前端技术
- **纯 HTML/CSS/JavaScript**: 无外部依赖
- **响应式设计**: 支持桌面和移动设备
- **现代化 UI**: 渐变色、动画、卡片式布局
- **实时更新**: 自动刷新监控数据

### 后端技术
- **Java 21**: 使用虚拟线程提高并发性能
- **内置 HTTP 服务器**: 使用 Java 自带的 HttpServer
- **轻量级**: 无需 Spring Boot 或其他 Web 框架
- **线程安全**: 使用 ConcurrentHashMap 和虚拟线程池

### 性能优化
- **虚拟线程**: 高并发低开销
- **异步处理**: 非阻塞 I/O
- **内存优化**: 自动清理旧会话和消息
- **快速启动**: 1-2 秒启动时间

## 使用场景

### 1. 日常 AI 助手
- 问答交互
- 文档查询
- 代码生成
- 数据分析

### 2. 开发工具
- 代码审查
- 文件操作
- 命令执行
- 日志分析

### 3. 系统监控
- 内存使用监控
- 性能分析
- 会话管理
- 健康检查

### 4. 教学演示
- AI 能力展示
- 工具调用演示
- 实时交互体验
- 系统架构说明

## 对比其他项目

### vs OpenClaw
- ✅ 相似的 Web 界面设计
- ✅ 完整的对话功能
- ✅ 工具调用支持
- ✅ 实时监控
- ➕ 更轻量（13 MB vs 100+ MB）
- ➕ 更快启动（1.4s vs 3-5s）

### vs 原始 nanobot
- ✅ 保持轻量级特性
- ✅ MCP 兼容
- ✅ 简洁架构
- ➕ 添加完整 Web 界面
- ➕ 多会话支持
- ➕ 实时监控面板

## 未来计划

### 短期计划
- [ ] 添加深色主题
- [ ] 支持文件上传
- [ ] 添加代码高亮
- [ ] 支持 Markdown 渲染
- [ ] 添加语音输入

### 中期计划
- [ ] 多用户支持
- [ ] 权限管理
- [ ] 插件系统
- [ ] 自定义主题
- [ ] 导出对话历史

### 长期计划
- [ ] 移动端 App
- [ ] 桌面端应用
- [ ] 浏览器扩展
- [ ] API 网关
- [ ] 分布式部署

## 常见问题

### Q: 如何更改端口？
A: 设置环境变量 `WEB_PORT=8080` 然后启动服务器。

### Q: 支持 HTTPS 吗？
A: 目前仅支持 HTTP，建议在生产环境使用反向代理（如 Nginx）添加 HTTPS。

### Q: 如何添加自定义工具？
A: 在 ToolRegistry 中注册新工具，Web 界面会自动显示。

### Q: 支持多用户吗？
A: 目前是单用户模式，多用户支持在未来计划中。

### Q: 如何备份对话历史？
A: 对话历史存储在内存中，重启后会清空。持久化存储功能正在开发中。

## 贡献

欢迎贡献代码和建议！请查看 [CONTRIBUTING.md](CONTRIBUTING.md)。

## 许可证

Apache License 2.0
